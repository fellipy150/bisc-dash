<!DOCTYPE html>
<html lang="pt-br">
	<head>
	  <meta charset="UTF-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	  <meta name="description" content="Página de boas-vindas da BiscBot para o servidor Biscast's™">
	  <title>BiscBot - Boas-vindas</title>
	  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
</head>
	<body>
		<header>
			<div class="header_right">
			<div class="logo">FELOS</div>
			<div class="user-icons">
				<i class="fas fa-user"></i>
				<i class="fas fa-bars"></i>
			</div>
			</div>
		</header>
		<main>
		<img src="https://i.ibb.co/TVmF5f9/bisc-bot-logo1.png" alt="BiscBot" class="biscbot-img">
		<div class="intro-box">tô na área! <br>eu sou a <strong>BiscBot</strong>! <br>
			<br>sou um projeto de bot criado para o servidor do discord <strong>Biscast's™</strong>!
		</div>

<div style="text-align: center; margin-top: 2rem;">
  <button id="loginButton" class="btn btn-primary" style="padding: 10px 20px; background-color: #7289DA; color: white; border: none; border-radius: 5px; font-weight: bold; cursor: pointer;">
    <i class="fab fa-discord"></i> Entrar com Discord
  </button>
</div>

		</main>
        <script>
  async function checkIndexLogin() {
    try {
      const response = await fetch('/api/get_guilds');
      if (response.ok) {
        window.location.href = '/dashboard.html';
      }
    } catch (error) {
      console.log('Usuário não logado ou erro na verificação.');
    }

    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    const errorElement = document.getElementById('error-message');
    if (error && errorElement) {
      let message = 'Ocorreu um erro durante a autenticação.';
      if (error === 'missing_params') message = 'Erro: Parâmetros ausentes no retorno do Discord.';
      if (error === 'invalid_state') message = 'Erro: Estado de autenticação inválido (possível CSRF). Tente novamente.';
      if (error === 'auth_failed') message = 'Erro: Falha ao autenticar com o Discord. Tente novamente.';
      errorElement.textContent = message;
    }
  }

  window.addEventListener('DOMContentLoaded', () => {
    checkIndexLogin();
    const loginBtn = document.getElementById('loginButton');
    if (loginBtn) {
      loginBtn.addEventListener('click', () => {
        window.location.href = '/api/auth_login';
      });
    }
  });
</script>
	</body>
</html>
